# lockfile 过时

## 1. package.json 只限制范围

* 没有 lockfile 的时候：

  * 你写 `"lodash": "^4.17.0"`，表示允许安装 **4.17.x** 的所有版本。
  * 你今天安装时，npm 可能给你 `4.17.21`。
  * 你同事明天安装时，可能给他的是刚发出来的 `4.17.22`。
  * 结果就是：同一个项目，不同人拿到的依赖版本不一致。

* 有 lockfile (`pnpm-lock.yaml`) 的时候：

  * 里面明确写死了“这次解析出来的就是 `4.17.21`”。
  * 无论谁来装，都会严格照着 lockfile 下 `4.17.21`。
  * 这样就保证了大家的依赖一致。

## pnpm install --lockfile-only

* 它会去 **npm 仓库拉最新的版本信息**，然后重新解析依赖。
* 如果发现有符合 `package.json` 范围的新版本，就会把新版本写进 **lockfile**。
* 但是它 **不会真正去下载** 新版本到 `node_modules/`，也不会动现有的依赖。

所以就会出现：

* `pnpm-lock.yaml` 记录的是新版本
* `node_modules` 还是旧版本
* pnpm 就会提示你：两者不同步（这就是你看到的警告）。
